\subsection{Models overview}

The logarithm was chosen as the link function for the location parameter in all models in order to prevent unrealistic predictions of negative basal area.

The confidence bands of the estimated smooth function effect in all models contained non-zero estimates (cp. \Cref{fig:GAM1EffectStandAgeVariable,fig:GAM1EffectProductivityIndexVariable,fig:GAM2EffectStandAgeVariable,fig:SCAM1EffectStandAgeVariable,fig:GAMLSS1EffectStandAgeVariable,fig:GAMLSS1EffectProductivityIndexVariable,fig:GAMLSS2EffectStandAgeVariable,fig:GAMLSS3EffectStandAgeVariable}).  This suggests that the stand age variable in all models and the \ProductivityIndexVariableText{} in models GAM1 and GAMLSS1 is related to the response variable \parencite{Wood2001}.

The sequence of models presented here, from GAM1 over GAM2 to SCAM1 and from GAMLSS1 over GAMLSS2 to GAMLSS3, may be seen as a sequence of increasingly constrained models.  GAM1 and GAMLSS1 contain the least constraints:  the effect of stand age variable and \ProductivityIndexVariableText{} on basal area is completely unrestricted and allowed to take on any shape.  In models GAM2 and GAMLSS2, the \ProductivityIndexVariableText{} is constrained to have a linear, rather than a smooth effect on basal area.  Finally, in models SCAM1 and GAMLSS3 the stand age variable smooth function is also constrained, namely to be either increasing and concave or monontone increasing, respectively.  The fact that model GAMLSS3 only imposes a monotone increasing constraint, rather than an increasing and concave constraint like model SCAM1, is due to the fact that no such constraint has been implemented in \texttt{R} package \texttt{gamlss} as of version \gamlssPackageVersion{}.
This imposition of increasingly strict constraints was motivated by the implausible results of the lesser restricted models.
In model GAM1, yield class \num{1} in \Beech{} performs better than yield class \num{0} while
yield class \num{-2} in \Spruce{} performs worse than yield class \num{1} throughout all stand ages between \SIrange{2}{160}{\year} (cp. \Cref{fig:GAM1StandAgeBasalAreaObservationsPredictionsYieldClassClassification}).
In model GAMLSS1, the same problem regarding predictions for \Beech{} persists (cp. \Cref{fig:GAMLSS1StandAgeBasalAreaObservationsPredictionsYieldClassClassification}).  Additionally, in both models the distance between yield classes \numlist{3;2} in \Beech{} and \numlist{-1;0} in \Spruce{} is much larger than between other adjacent yield classes.  Compared to the values reported in \textcite{Schober1995}, which are depicted in \Cref{fig:StandAgeBasalAreaSchober}, this irregularity in distance appears implausible.
In models GAM2 and GAMLSS2, linearization of the \ProductivityIndexVariableText{} eliminated these irregularities (cp. \Cref{fig:GAM2StandAgeBasalAreaObservationsPredictionsYieldClassClassification,fig:GAMLSS2StandAgeBasalAreaObservationsPredictionsYieldClassClassification}).  However, basal area predictions remain implausible, since in the case of \Beech{}, basal area is predicted to decrease after approximately \SI{80}{\year} in all yield classes, whereas in the case of \Spruce{}, basal area increases indefinitely in all yield classes.  Both results are not in conjunction with values reported in \textcite{Schober1995} (moderate thinning), which suggest no decrease in basal area for \Beech{} at least up to \SI{150}{\year} for yield classes \numrange{1}{4}, and a decrease in basal area for yield classes \numrange{1}{4} of \Spruce{} after \SI{100}{\year} the latest (cp. \Cref{fig:StandAgeBasalAreaSchober}).  Similarly, \textcite{Franz1965} reports \Spruce{} stands to reach a maximum basal area at around \SI{120}{\year}.
These remaining implausibilities were partly met by the additional constraints imposed in models SCAM1 and GAMLSS3 (cp. \Cref{fig:SCAM1StandAgeBasalAreaObservationsPredictionsYieldClassClassification,fig:GAMLSS3StandAgeBasalAreaObservationsPredictionsYieldClassClassification}).  Basal area predictions for \Beech{} show no decrease for stand ages up to \SI{160}{\year}, but rather an asymptotic behavior, reaching their maximum at around \SI{67}{\year} in the case of SCAM1 and around \SI{80}{\year} in the case of GAMLSS3.  While neither of these values is in accordance with the basal area development reported by \textcite{Schober1995}, the predictions for \Beech{} of models SCAM1 and GAMLSS3 nevertheless appear more plausible than those of models GAM2 and GAMLSS2, respectively.  In the case of \Spruce{}, the difference between model SCAM1, which imposes both an increasing as well as a concavity constraint, and model GAMLSS3, which only imposes a monontone increasing constraint, becomes apparent.  While in both models basal area predictions increase indefinitely, the increase is remarkably smaller in SCAM1, which predicts, at \SI{160}{\year}, a basal area of roughly \SI{93}{\square\meter\per\hectare} for yield class \num{-2} and of about \SI{55}{\square\meter\per\hectare} for yield class \num{4}, whereas GAMLSS3, for the same age and yield classes, predicts a basal area of approximately \SIlist{138;81}{\square\meter\per\hectare}, respectively.
In \Cref{fig:SCAM1TopHeightBasalAreaObservationsPredictionsYieldClassClassification}, which depicts predicted basal area over top height for model SCAM1, in both species the order of prediction curves initially is the inverse of yield class order, but shifts during a certain range of top heights, so that finally it is the same as yield class order.
The same is true for \Beech{} in model GAMLSS3 (cp. \Cref{fig:GAMLSS3TopHeightBasalAreaObservationsPredictionsYieldClassClassification}).  These shifts are due to the fact that prediction curves of low productivity yield classes level off or show a decrease in slope at lower top heights than do curves of higher productivity yield classes.
The reason for this becomes apparent when considering \Cref{fig:StandAgeTopHeightTestData}, which depicts the relationship between top height and stand age in the test data sets (on which model predictions were based):  for a given top height, age increases as yield class worsens.  Thus, the asymptotic behavior or the decrease in slope of the prediction curves occurs at lower top heights the worse a stand’s yield class is, but still at approximately the same stand age in all yield classes for each species (cp. \Cref{fig:SCAM1StandAgeBasalAreaObservationsPredictionsYieldClassClassification,fig:GAMLSS3StandAgeBasalAreaObservationsPredictionsYieldClassClassification}).  Similar shifts of curve order can be observed in the predictions of other models as well, owing to the same properties of the test data sets.
All things considered, the chosen constraints improved plausibility of model predictions.

However, the more constrained models also generally achieved higher (i.e., worse) AIC scores than the less constrained models (cp. \Cref{tab:AICOverview}), with the notable exception of GAMLSS3 for \Spruce{}, which achieved the lowest AIC for that species.  A reason for this discrepancy between plausibility and statistical power of the models may lie in the incompleteness of the training data sets discussed above.  At the same time, the GAMLSSs generally achieved a lower AIC than the correpsonding GAM or SCAM, again with the notable exception of GAMLSS3 in \Spruce{}.  This suggests that the increased uncertainty of GAMLSSs compared to GAMs or SCAMs was outweighed by their increased flexibility.

While basal area modeling, both at individual tree level (e.g., \textcite{Andreassen2003,Hein2006,Jogiste2000,Monserud1996,Nystroem1997,Schroeder2002,Wimberly1996}) as well as stand level (e.g., \textcite{Castedo-Dorado2007,Chikumbo2001,Chikumbo1999,Eerikaeinen2003}), has been the subject of several studies, modeling of \emph{maximum} basal area has not gathered as much attention.  To the best knowledge of the author, only two approaches have been made (\textcite{Sterba1975,Sterba1987,Sterba1981} and \textcite{Woerdehoff2016}), none of which take differences in stand productivity into account.
The method presented by Sterba results from applying the “competition-density rule” developed by \textcite{Kira1953,Ando1968,Ando1968a,Tadaki1963} on mean diameter as suggested by \textcite{Goulding1972}, rather than on mean volume.  It allows prediction of maximum basal area using the equation
% \begin{equation}
  % \label{eq:SterbaNGmax}
  % \SterbaNGmaxMath{} = \frac{b_0}{a_0} \TopHeightMath{} ^ {b_1 - a_1},
% \end{equation}
\begin{equation}
  \label{eq:SterbaGmax}
  \SterbaGmaxMath{} = \frac{\pi}{16~a_0~b_0} \TopHeightMath{} ^ {-(a_1 + b_1)},
\end{equation}
% and
% \begin{equation}
  % \label{eq:SterbadgGmax}
  % \SterbadgGmaxMath{} = \frac{1}{2 b_o} \TopHeightMath{} ^ {-b_1},
% \end{equation}
% where \(\SterbaNGmaxMath{}\) is stand density at maximum basal area, \(a_0, a_1, b_0, b_1\) are coefficients to be estimated, \(\TopHeightMath{}\) is top height, \(\SterbaGmaxMath{}\) is maximum basal area, and \(\SterbadgGmaxMath{}\) is the diameter of the mean basal area tree.
where \(\SterbaGmaxMath{}\) is maximum basal area, \(a_0, a_1, b_0, b_1\) are coefficients to be estimated, and \(\TopHeightMath{}\) is top height.
In order to use \Cref{eq:SterbaGmax} for predicting maximum basal area, the equation needs to be fit to top height observations of maximum basal area stands in order to obtain valid estimates of \(a_0, a_1, b_0, \text{ and } b_1\).   \Cref{eq:SterbaGmax} uses only top height as an independent variable, thus offering no option to incorporate stand productivity as a predictor.
As a consequence, predictions obtained from \Cref{eq:SterbaGmax} are strictly only valid for stands which are of approximately the same yield class as the observations used for fitting it.  In order to obtain maximum basal area predictions for different yield classes, a new set of equation coefficients needs to be estimated, based on a suitable data set of top height and maximum basal area observations for the respective yield class.
Fitting of \Cref{eq:SterbaGmax} to the data sets used in the present study was not successful.  In order to nevertheless compare predictions of the most plausible models presented in this study (GAMLSS3 for \Beech{} and SCAM1 for \Spruce{}) with predictions of \Cref{eq:SterbaGmax}, coefficient estimates reported by \textcite{Doebbeler2004} (Region Nordwest) and \textcite{Woerdehoff2016} for \Beech{} and \Spruce{}, which are given in \Cref{tab:SterbaCoefficientsEstimatesDöbbeler,tab:SterbaCoefficientsEstimatesWördehoff}, respectively, were used .  The results are shown in \Cref{fig:TopHeightBasalAreaObservationsGAMLSS3SCAM1SterbaPredictionsYieldClassClassification}.  In the case of \Beech{}, \Cref{eq:SterbaGmax}, particularly when using the \textcite{Doebbeler2004} estimates, predicts notably higher basal areas for lower top heights than does model SCAM1 for yield classes \numrange{3}{-2}.  This relation then switches with increasing top height, so that for top heights above \SI{30}{\meter} and below \SI{50}{\meter} \Cref{eq:SterbaGmax} predicts lower basal areas than does model SCAM1 for yield class \num{-2}.  Unlike those of model SCAM1, however, predictions of \Cref{eq:SterbaGmax} continue to increase at a top height of \SI{60}{\meter}.  In the case of \Spruce{}, relations between predictions of \Cref{eq:SterbaGmax} and of model GAMLSS3 behave similarly to those described above.  For lower top heights, the former predicts higher basal areas than does the latter for yield classes \numrange{2}{-2}.  For higher top heights, \Cref{eq:SterbaGmax} predicts lower basal areas than does GAMLSS3 for yield classes \numrange{3}{-2} (\textcite{Woerdehoff2016} estimates) or for yield classes \numrange{0}{-2} (\textcite{Doebbeler2004} estimates).  While models SCAM1 and GAMLSS3 do suffer from certain inconsistencies discussed above, they nevertheless offer greater flexibility in terms of incorporating stand productivity as a predictor of maximum basal area than does \Cref{eq:SterbaGmax}.
\textcite{Woerdehoff2016} used a GAMLSS for modeling maximum basal area.  However, unlike the models presented in this study, it only contained top height as a dependent variable, thus having the same restrictions as \eqref{eq:SterbaGmax} in terms of incorporating stand productivity as a predictor.  \Cref{fig:TopHeightBasalAreaObservationsGAMLSS3SCAM1WoerdehoffPredictionsYieldClassClassification} shows the predictions of the GAMLSS of \textcite{Woerdehoff2016} fitted to the data sets used in the present study.  %% CONTINUE HERE (Wördehoff predictions of Beech appear to be strongly influenced by the low productivity outliers)



Following \textcite{Baur1881} (cited in \textcite[p. 159]{Assmann1970}), this study rests on the so-called “site index hypothesis” \parencite{Skovsgaard2008}, which may be broken down into 2 assumptions:
\begin{enumerate}
\item Yield classes can be sufficiently distinguished based on top height at a given reference age, i.e., their site index.
\item Stands of different yield classes attain different basal areas at a given age, while stands of the same yield class attain the same basal area at a given age.
\end{enumerate}
These assumptions are based on the belief that top height in pure even-aged unthinned stands is largely independent of stem number \parencite{Skovsgaard2008}.  
They are, however, are not undisputed.  \textcite{Assmann1970} pointed out that stands sharing the same site index still show site-dependent differences in total crop yield as well as basal area.  Nevertheless, site index continues to be a subject of research \parencite{Weiskittel2011,Somarriba2001,Wang2005} and was considered an indicator of site productivity by others \parencite{Monserud1984,Rayner1992,Karlsson1997}.  The goal of this study was not to determine whether or not site index is an appropriate measure for classfying site productivity, but rather to develop tools which allow modeling of maximum basal area while also taking differences of site productivity into account.  Whether these differences are expressed in terms of site index or by other means is of no relevance in this regard.

\newpage{}  %% TESTING
\begin{singlespace}
    {\tabulinesep=2mm
    \begin{longtabu}{L S[table-format = 1.6e-1] S[table-format = 1.6] S[table-format = 1.6] S[table-format = -1.6]}  %% Note: there seems to be no way around manually setting the "table-format", since siunitx apparently has no mechanism for guessing the correct settings and the default settings (which are equivalent to "table-format = 3.2e0", see manual p. 44) are almost guaranteed to be inappropriate.
      \caption{Estimates of the coefficients of \Cref{eq:SterbaGmax} for \Beech{} as reported in \textcite{Doebbeler2004} (Region Nordwest) and \textcite{Woerdehoff2016}.
        \label{tab:SterbaCoefficientsEstimatesDöbbeler}} \\
      \toprule
      Source & {\(a_0\)} & {\(a_1\)} & {\(b_0\)} & {\(b_1\)} \\
      \midrule
      \endhead
      \bottomrule
      \endlastfoot
      \textcite{Doebbeler2004} & 1.0829e-7 & 1.5374 & 8.3652 & -1.7365 \\
      \textcite{Woerdehoff2016} & 2.616551e-7 & 1.368151 & 6.496417 & -1.731867 \\
      \end{longtabu}
    }
\end{singlespace}

\begin{singlespace}
    {\tabulinesep=2mm
    \begin{longtabu}{L S[table-format = 1.6e-1] S[table-format = 1.6] S[table-format = 1.6] S[table-format = -1.6]}  %% Note: there seems to be no way around manually setting the "table-format", since siunitx apparently has no mechanism for guessing the correct settings and the default settings (which are equivalent to "table-format = 3.2e0", see manual p. 44) are almost guaranteed to be inappropriate.
      \caption{Estimates of the coefficients of \Cref{eq:SterbaGmax} for \Spruce{} as reported in \textcite{Doebbeler2004} (Region Nordwest) and \textcite{Woerdehoff2016}.
        \label{tab:SterbaCoefficientsEstimatesWördehoff}} \\
      \toprule
      Source & {\(a_0\)} & {\(a_1\)} & {\(b_0\)} & {\(b_1\)} \\
      \midrule
      \endhead
      \bottomrule
      \endlastfoot
      \textcite{Doebbeler2004} & 1.28745e-6 & 0.7148 & 1.2842 & -1.1914 \\
      \textcite{Woerdehoff2016} & 4.913256e-6 & 0.4394706 & 0.3716977 & -0.9097641 \\
      \end{longtabu}
    }
\end{singlespace}

\begin{figure}[h]
  \centering
  \includegraphics[width=1.0\textwidth]{../../Graphics/Thesis/StandAgeBasalAreaSchober.pdf}
  \caption{Basal area (\(G\)) over stand age of \Beech{} and \Spruce{} as reported in \textcite{Schober1995} (moderate thinning).  Color signifies yield class.}
  \label{fig:StandAgeBasalAreaSchober}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=1.0\textwidth]{../../Graphics/Thesis/StandAgeTopHeightTestData.pdf}
  \caption{Top height (\(\TopHeightMath{}\)) over stand age of \Beech{} and \Spruce{} in the test data.  Test data was generated using \Cref{eq:NagelFunctionSolvedForTopHeight}.  Line color has the same meaning as in \Cref{fig:GAMLSS3TopHeightBasalAreaObservationsPredictionsYieldClassClassification}, namely:  Color signifies the (fractional) yield class of the test data, ranging from red (worst yield class observed in the training data) over yellow and green to blue (best yield class observed in the training data).  Yield class classification was based on \textcite{Schober1995} (moderate thinning).  Note the different yield class ranges in both plots.}
  \label{fig:StandAgeTopHeightTestData}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=1.0\textwidth]{../../Graphics/Thesis/TopHeightBasalAreaObservationsGAMLSS3SCAM1SterbaPredictionsYieldClassClassification.pdf}
  \caption{Basal area (\(G\)) over top height \(\TopHeightMath{}\) of \Beech{} (top) and \Spruce{} (bottom). Depicted are observations as well as predictions of 3 different models per plot.  Colored lines represent predictions of model GAMLSS3 (top) or of model SCAM1 (bottom).  Dashed lines represent predictions of \Cref{eq:SterbaGmax}, using the coefficient estimates reported by \textcite{Woerdehoff2016} for the respective species.  Dotted lines represent predictions of \Cref{eq:SterbaGmax}, using the coefficient estimates reported by \textcite{Doebbeler2004} (Region Nordwest) for the respective species.  Dots, solid black lines, and colors have the same meaning as in \Cref{fig:GAMLSS3TopHeightBasalAreaObservationsPredictionsYieldClassClassification}, namely:  Each dot represents one observation.  Solid black lines connect observations belonging to the same sample plot.  Color signifies the (fractional) yield class of the respective observation or prediction, ranging from red (worst yield class observed) over yellow and green to blue (best yield class observed).  Yield class classification was based on \textcite{Schober1995} (moderate thinning).  Note the different yield class ranges in both plots.}
  \label{fig:TopHeightBasalAreaObservationsGAMLSS3SCAM1SterbaPredictionsYieldClassClassification}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=1.0\textwidth]{../../Graphics/Thesis/TopHeightBasalAreaObservationsGAMLSS3SCAM1WoerdehoffPredictionsYieldClassClassification.pdf}
  \caption{Basal area (\(G\)) over top height \(\TopHeightMath{}\) of \Beech{} (top) and \Spruce{} (bottom). Depicted are observations as well as predictions of 2 different models per plot.  Colored lines represent predictions of model GAMLSS3 (top) or of model SCAM1 (bottom).  Dashed lines represent predictions of the GAMLSS reported by \textcite{Woerdehoff2016} fitted to the respective species’s data set.  Dots, solid black lines, and colors have the same meaning as in \Cref{fig:GAMLSS3TopHeightBasalAreaObservationsPredictionsYieldClassClassification}, namely:  Each dot represents one observation.  Solid black lines connect observations belonging to the same sample plot.  Color signifies the (fractional) yield class of the respective observation or prediction, ranging from red (worst yield class observed) over yellow and green to blue (best yield class observed).  Yield class classification was based on \textcite{Schober1995} (moderate thinning).  Note the different yield class ranges in both plots.}
  \label{fig:TopHeightBasalAreaObservationsGAMLSS3SCAM1WoerdehoffPredictionsYieldClassClassification}
\end{figure}

% \clearpage{}  %% This is necessary, because otherwise the following "longtabu" environment produces a spurious table, which contains only the head but no cells.

\clearpage{}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "MasArThesis.tex"
%%% End:
