\subsection{Model overview}

\begin{table}[H]
  {\tabulinesep=2mm
    \begin{longtabu}{L l l l}
      \caption{Overview of the \texttt{R} functions and formulas used for model fitting. The overview includes
        the model ID,
        the name of the \texttt{R} package (and its version number) which provided the model fitting function,
        the name of the \texttt{R} model fitting function,
        and the formula used in the model fitting function call.
        In the case of GAMLSS1, GAMLSS2, and GAMLSS3, the formula applies only to the location parameter of the assumed probability distribution.
        For all other distribution parameters, the formula was \texttt{\BasalAreaR{} \textasciitilde{} 1}. \\
        \BasalAreaR{}: basal area \\
        \StandAgeVariableR{}: stand age variable (cp. \Cref{eq:StandAgeVariable}) \\
        \ProductivityIndexVariableR{}: \ProductivityIndexVariableText{} (cp. \Cref{eq:ProductivityIndexVariable})
        \label{tab:PresentedModelsOverviewFormulas}} \\
      \toprule
      Model ID & Package (Version) & Fitting function & Formula \\
      \midrule
      \endhead
      \bottomrule
      \endlastfoot
      GAM1 & \texttt{mgcv} (1.8.22) & \texttt{gam} & \texttt{\BasalAreaR{} \textasciitilde{} s(\StandAgeVariableR{}) + s(\ProductivityIndexVariableR{})} \\
      GAM2 & As above & As above & \texttt{\BasalAreaR{} \textasciitilde{} s(\StandAgeVariableR{}) + \ProductivityIndexVariableR{}} \\
      SCAM1 & \texttt{scam} (1.2.2) & \texttt{scam} & \texttt{\BasalAreaR{} \textasciitilde{} s(\StandAgeVariableR{}, bs = "micv") + \ProductivityIndexVariableR{}} \\
      GAMLSS1 & \texttt{gamlss} (5.0.4) & \texttt{gamlss} & \texttt{\BasalAreaR{} \textasciitilde{} ps(\StandAgeVariableR{}) + ps(\ProductivityIndexVariableR{})} \\
      GAMLSS2 & As above & As above & \texttt{\BasalAreaR{} \textasciitilde{} ps(\StandAgeVariableR{}) + \ProductivityIndexVariableR{}} \\
      GAMLSS3 & As above & As above & \texttt{\BasalAreaR{} \textasciitilde{} pbm(\StandAgeVariableR{}) + \ProductivityIndexVariableR{}} \\
      \bottomrule
    \end{longtabu}}
\end{table}

\begin{table}[H]
  {\tabulinesep=2mm
    \begin{longtabu}{L l l}
      \caption{Overview of the \texttt{R} distribution functions used for model fitting.  The overview includes
        the model ID,
        the name of the \texttt{R} package (and its version number) which provided the distribution function,
        and the \texttt{R} call of the distribution function used in model fitting.
        \label{tab:PresentedModelsOverviewDistributions}} \\
      \toprule
      Model ID & Package (Version) & Distribution function call \\
      \midrule
      \endhead
      \bottomrule
      \endlastfoot
      GAM1 & \texttt{stats} (3.3.3) & \texttt{Gamma(link = "log")} \\
      GAM2 & As above & As above \\
      SCAM1 & As above & As above \\
      GAMLSS1 & \texttt{gamlss.dist} (5.0.3) & \texttt{BCCGo()} \\
      GAMLSS2 & As above & As above \\
      GAMLSS3 & As above & As above \\
      \bottomrule
    \end{longtabu}}
\end{table}

\Cref{tab:PresentedModelsOverviewFormulas,tab:PresentedModelsOverviewDistributions} provide an overview of the settings used for model fitting:  \Cref{tab:PresentedModelsOverviewFormulas} reports the \texttt{R} functions and formulas used for model fitting, while \Cref{tab:PresentedModelsOverviewDistributions} reports the probability distributions assumed for each model.  For each species, 6 different models were fitted: 2 GAMs, one SCAM, and 3 GAMLSSs.  The settings for a given model were the same for \Beech{} and \Spruce{}.
In the formulas reported in \Cref{tab:PresentedModelsOverviewFormulas}, the \texttt{\textasciitilde{}} character separates the dependent variable (on the left) from the predictor terms (on the right), while the \texttt{+} character separates individual predictor terms. 
In the case of GAM1 and GAM2, the \texttt{s(\textnormal{\ldots})} formula terms are smooth functions using thin plate regression splines as their function basis.  In the case of SCAM1, the \texttt{s(\textnormal{\ldots{}}, bs = "micv")} formula term is a smooth function using P-splines constrained to be increasing and concave as its function basis.  In all smooth functions of the GAMs and SCAM, the setting of basis dimension and order of penalty is left to the smooth function.  In the case of GAMLSS1 and GAMLSS2, the \texttt{ps(\textnormal{\ldots})} formula terms are smooth functions using P-splines as their function basis.  In the case of GAMLSS3, the \texttt{pbm(\textnormal{\ldots{}})} term is a smooth function using P-splines constrained to be montonone increasing as its function basis.  In all smooth functions of the 3 GAMLSSs, function basis degree was set to 3, function basis order was set to 2, the number of spline knots was set to 20, while selection of the smoothing parameter was left to the smooth function. For all GAMLSSs, the formula reported in \Cref{tab:PresentedModelsOverviewFormulas} applies only to the location parameter of the assumed probability distribution. All other distribution parameters were modeled as constants (i.e., with formula \texttt{\BasalAreaR{} \textasciitilde{} 1}).  Models GAM1 and GAMLSS1 use smooth functions for both the stand age variable as well as the \ProductivityIndexVariableText{}.  All other models use smooth functions only for the stand age variable while the \ProductivityIndexVariableText{} is included as a linear predictor.  None of the 6 models consider interactions between the predictor terms.

As reported in \Cref{tab:PresentedModelsOverviewDistributions}, models GAM1, GAM2, and SCAM1 assume the logarithm of basal area to follow Gamma distribution.  The probability density function and cumulative distribution function of a variable following Gamma distribution are given by
\begin{equation}
  \label{eq:GammaDistributionPDF}
  P(X = x|k, \theta) = x^{k - 1} \frac{\exp{\left(\frac{-x}{\theta}\right)}}{\theta^k \upGamma(k)} \quad \text{for } x \geq 0, ~ k, \theta > 0
\end{equation}
and
\begin{equation}
  \label{eq:GammaDistributionCDF}
    D(X = x|k, \theta) = 1 - \frac{\upGamma_{\text{i}}\left(k, \frac{x}{\theta}\right)}{\upGamma(k)} \quad \text{for } x \geq 0, ~ k, \theta > 0,
\end{equation}
respectively, where \(k\) is the shape parameter, \(\theta\) is the scale parameter, \(\upGamma\) is the complete Gamma function, and \(\upGamma_{\text{i}}\) is the incomplete Gamma function \parencite{Weisstein2017b,Dormann2013,Lindgren1976}.  To prevent implausible negative predictions of basal area, the logarithm function was chosen as the link function, rather than the inverse function which is the default of function \texttt{Gamma}.  Models GAMLSS1, GAMLSS2, and GAMLSS3 assume the logarithm of basal area to follow Box-Cox-Cole-Green distribution. This distribution is the Box-Cox transformation model presented by \textcite{Cole1992} \parencite{Stasinopoulos2007}.  Based on the transformations suggested by \textcite{Box1964}, the model first transforms the dependent variable \(y\) such that
\begin{equation}
  \label{eq:BoxCoxColeGreenTransformation}
  x =
  \begin{cases}
    \frac{\left(
        y \middle/ \mu
      \right)^\nu - 1}{\nu} &\text{if } \nu \not = 0 \\
    \log\left(y \middle/ \mu\right) &\text{if } \nu = 0,
  \end{cases}
\end{equation}
where \(x\) is the transformed variable, \(\mu\) is the mean of \(y\), and \(\nu\) is the Box-Cox power of \(y\) \parencite{Cole1992}.
The standard deviation score of \(x\) is given by
\begin{equation}
  \label{eq:BoxCoxColeGreenSDScore}
  z = \frac{x}{\sigma},
\end{equation}
where \(z\) is the standard deviation score of \(x\) and \(\sigma\) is the coefficient of variation of \(y\) .  It is assumed that \(z\) follows a standard normal distribution, i.e., a normal distribution with mean 0 and variance 1. Thus, the probability density function of \(z\) is given by
\begin{equation}
  \label{eq:StandardNormalDistributionPDF}
  P(Z = z|0, 1) =
  \frac{\exp{\left(-\frac{z^2}{2}\right)}}{\sqrt{2 \pi}}
\end{equation}
while its cumulative distribution function is given by
\begin{equation}
  \label{eq:StandardNormalDistributionCDF}
  D(Z = z|0, 1) =
  \frac{\erf\left(\frac{z}{\sqrt{2}}\right) + 1}{2}
  \end{equation}
\parencite{Henze2013,Weisstein2017c}.  Substituting \(z\) in \Cref{eq:StandardNormalDistributionPDF,eq:StandardNormalDistributionCDF} using \Cref{eq:BoxCoxColeGreenTransformation,eq:BoxCoxColeGreenSDScore} yields the probabilty density function and the cumulative distribution function of \(y\)
\begin{equation}
  \label{eq:BoxCoxColeGreenDistributionPDF}
  P(Y = y|\mu, \sigma, \nu) =
  \begin{cases}
    \frac{\exp\left(-\frac{\left(\left(y \middle/ \mu\right)^\nu - 1\right)^2}{2 \nu^2 \sigma^2}\right)}{\sqrt{2 \pi}} &\text{if } \nu \not = 0 \vspace{0.5em} \\
    \frac{\exp\left(-\frac{\log\left(y \middle/ \mu\right)^2}{2 \sigma^2}\right)}{\sqrt{2 \pi}} &\text{if } \nu = 0
  \end{cases}
\end{equation}
and
\begin{equation}
  \label{eq:BoxCoxColeGreenDistributionCDF}
  D(Y = y|\mu, \sigma, \nu) =
  \begin{cases}
    \frac{1}{2} \left(\erf\left(\frac{\left( y \middle/ \mu \right)^\nu - 1}{\sqrt{2} \nu \sigma}\right) + 1\right) &\text{if } \nu \not = 0 \vspace{0.5em} \\
    \frac{1}{2} \left(\erf\left(\frac{\log\left( y \middle/ \mu \right)}{\sqrt{2} \sigma}\right) + 1\right) &\text{if } \nu = 0,
  \end{cases}
\end{equation}
respectively, where \(\mu\), \(\sigma\), and \(\nu\) have the same meaning as in \Cref{eq:BoxCoxColeGreenTransformation,eq:BoxCoxColeGreenSDScore}, namely: \(\mu\) is the mean of \(y\), \(\sigma\) is the coefficient of variation of \(y\), and \(\nu\) is the Box-Cox power of \(y\).  The function \texttt{BCCGo} uses the logarithm function as the link function for \(\mu\), which prevents implausible predictions of negative basal area.  The link functions for distribution parameters \(\sigma\) and \(\nu\) are the logarithm function and the identity function, respectively.

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "MasArThesis.tex"
%%% End:
