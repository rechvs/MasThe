\begin{landscape}
  \begin{figure}[h]
    \caption{Flowchart representing the mechanism used for identifying and removing observations which were not considered to be maximum stand density-observations based on the slope \(s\) of \refeq{eq:reineke} between adjacent observations. \\
      \(s_l\): species-specific lower threshold for the slope of \refeq{eq:reineke} (cp. \reftab{tab:ReinekeSlopeThresholds}). \\  %% Note: the hyperlinks in this caption are not placed ontop of the corresponding printed character, but at a seemingly random distance behind it. I am currently (2017-10-03) unsure about the cause of this and thus donâ€™t know of any fix for it.
      \(s_f\): slope of \refeq{eq:reineke} between current and following observation. \\
      \(s_p\): slope of \refeq{eq:reineke} between current and previous observation. \\
      \(s_u\): species-specific upper threshold for the slope of \refeq{eq:reineke} (cp. \reftab{tab:ReinekeSlopeThresholds}).}
    \label{fig:DataSelectionFlowChart}
  {
    \footnotesize
    % \small
    \begin{tikzpicture}[>=stealth,node distance = 0.5]
      %% Start.
      \node (Start1-1) at(0, 0) [DataSelectionFlowChartStart] {Start loop at first \\ observation.};
      %% Questions.
      \node (Question1-1) at(7.5, 0) [DataSelectionFlowChartQuestion] {At which observation \\ are we~?};
      \node (Question2-1) at(5, -3.5) [DataSelectionFlowChartQuestion] {Is \(s_f \leq s_u\)~?};
      \node (Question2-2) at(10, -3.5) [DataSelectionFlowChartQuestion] {Is \(s_l \leq s_p\) \\ AND \(s_f \leq s_u\)~?};
      \node (Question2-3) at(15, -3.5) [DataSelectionFlowChartQuestion] {Is \(s_l \leq s_p\)~?};
      %% Actions.
      \node (Action1-1) at(0,-7) [DataSelectionFlowChartAction] {delete \\ observation};
      \node (Action1-2) at(6,-7) [DataSelectionFlowChartAction] {delete \\ observation};
      \node (Action1-3) at(11,-7) [DataSelectionFlowChartAction] {delete \\ observation};
      \node (Action1-4) at(16,-7) [DataSelectionFlowChartAction] {delete \\ observation};
      \node (Action2-1) at(7.5, -9) [DataSelectionFlowChartAction] {move to \\ following observation};
      %% Results (drawn last because they should cover any lines with which they overlap).
      \node (Result1-1) at(0, -1.9) [DataSelectionFlowChartResult] {first, which is also the last};
      \node (Result1-2) at(5, -1.9) [DataSelectionFlowChartResult] {first, but not last};
      \node (Result1-3) at(10, -1.9) [DataSelectionFlowChartResult] {intermediate};
      \node (Result1-4) at(15, -1.9) [DataSelectionFlowChartResult] {last, but not first};
      \node (Result2-1) at(3.5, -5.5) [DataSelectionFlowChartResult] {TRUE};
      \node (Result2-2) at(6, -5.5) [DataSelectionFlowChartResult] {FALSE};
      \node (Result2-3) at(8.5, -5.5) [DataSelectionFlowChartResult] {TRUE};
      \node (Result2-4) at(11, -5.5) [DataSelectionFlowChartResult] {FALSE};
      \node (Result2-5) at(13.5, -5.5) [DataSelectionFlowChartResult] {TRUE};
      \node (Result2-6) at(16, -5.5) [DataSelectionFlowChartResult] {FALSE};
      %% End.
      \node (End1-1) at(0, -9) [DataSelectionFlowChartEnd] {Exit loop.};
      %% Horizontal lines and arrows.
      \draw [DataSelectionFlowChartArrow] (Start1-1.east) -- (Question1-1.west); \draw [DataSelectionFlowChartArrow] (19, 0) -- (Question1-1.east);
      \draw [DataSelectionFlowChartLine] (3.5, -8) -- (11, -8); \draw [DataSelectionFlowChartLine] (13.5, -8) -- (16, -8);
      \draw [DataSelectionFlowChartLine] (Action2-1.east) -- (19, -9);
      \draw [DataSelectionFlowChartLine] (13.5, -10.25) -- (0, -10.25);
      %% Vertical lines.
      \draw [DataSelectionFlowChartArrow] (Result1-1.south) -- (Action1-1.north); \draw [DataSelectionFlowChartArrow] (Action1-1.south) -- (End1-1.north); \draw [DataSelectionFlowChartArrow] (0, -10.25) -- (End1-1.south); 
      \draw [DataSelectionFlowChartArrow] (Result1-2.south) -- (Question2-1.north);
      \draw [DataSelectionFlowChartArrow] (Result1-3.south) -- (Question2-2.north);

      \draw [DataSelectionFlowChartArrow] (7.5, -8) -- (Action2-1.north);

      \draw [DataSelectionFlowChartArrow] (Result1-4.south) -- (Question2-3.north);
      
      \draw [DataSelectionFlowChartLine] (Result2-1.south) -- (3.5, -8);
      \draw [DataSelectionFlowChartArrow] (Result2-2.south) -- (Action1-2.north); \draw [DataSelectionFlowChartLine] (Action1-2.south) -- (6, -8);

      \draw [DataSelectionFlowChartLine] (Result2-3.south) -- (8.5, -8);
      \draw [DataSelectionFlowChartArrow] (Result2-4.south) -- (Action1-3.north); \draw [DataSelectionFlowChartLine] (Action1-3.south) -- (11, -8);

      \draw [DataSelectionFlowChartLine] (Result2-5.south) -- (13.5, -8.9); \draw [thick] (13.5, -8.9) arc [start angle = 90, end angle = 270, radius = 0.1]; \draw [DataSelectionFlowChartLine] (13.5, -9.1) -- (13.5, -10.25);

      \draw [DataSelectionFlowChartArrow] (Result2-6.south) -- (Action1-4.north); \draw [DataSelectionFlowChartLine] (Action1-4.south) -- (16, -8);
      
      \draw [DataSelectionFlowChartLine] (19, -9) -- (19, 0);
      %% Slanted lines.
      \draw [DataSelectionFlowChartLine] (Question1-1.south) -- (Result1-1.north);
      \draw [DataSelectionFlowChartLine] (Question1-1.south) -- (Result1-2.north);
      \draw [DataSelectionFlowChartLine] (Question1-1.south) -- (Result1-3.north);
      \draw [DataSelectionFlowChartLine] (Question1-1.south) -- (Result1-4.north);

      \draw [DataSelectionFlowChartLine] (Question2-1.south) -- (Result2-1.north);
      \draw [DataSelectionFlowChartLine] (Question2-1.south) -- (Result2-2.north);
      \draw [DataSelectionFlowChartLine] (Question2-2.south) -- (Result2-3.north);
      \draw [DataSelectionFlowChartLine] (Question2-2.south) -- (Result2-4.north);
      \draw [DataSelectionFlowChartLine] (Question2-3.south) -- (Result2-5.north);
      \draw [DataSelectionFlowChartLine] (Question2-3.south) -- (Result2-6.north);
      %% Legend.
      % \draw [thick,dashed] (-2, -11) rectangle (14, -13);

      % \node[anchor=west] (LegendTitle) at(-1.9, -12) {\textbf{Legend:}};

      % \node (LegendStart)  [DataSelectionFlowChartStart,right=of LegendTitle] {Loop start};

      % \node (LegendQuestion) [DataSelectionFlowChartQuestion,right=of LegendStart] {Question/Test};

      % \node (LegendResult) [DataSelectionFlowChartResult,right=of LegendQuestion] {Answer/Result};

      % \node (LegendAction) [DataSelectionFlowChartAction,right=of LegendResult] {Action};

      % \node (LegendEnd) [DataSelectionFlowChartEnd,right=of LegendAction] {Loop end};
      
    \end{tikzpicture}}
\end{figure}
\end{landscape}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "MasAr_Thesis.tex"
%%% End:
